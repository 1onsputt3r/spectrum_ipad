<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>é›¢ç·šæ¸¬è©¦</title>
  <style>
    body {
      font-family: "Helvetica Neue", sans-serif;
      padding: 2em;
      line-height: 1.6;
      background: #f8f8f8;
    }
    h1 {
      color: #333;
    }
    pre {
      background: #fff;
      border: 1px solid #ccc;
      padding: 1em;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
  </style>
</head>
<body>
  <h1>ğŸ“´ é›¢ç·šæ¸¬è©¦ç‹€æ…‹</h1>
  <pre id="status">æª¢æŸ¥ä¸­...</pre>

  <script>
    async function checkStatus() {
      let status = '';

      // 1. æ˜¯å¦æ”¯æ´ Service Worker
      if ('serviceWorker' in navigator) {
        const registrations = await navigator.serviceWorker.getRegistrations();
        if (registrations.length === 0) {
          status += 'âŒ æ²’æœ‰è¨»å†Šä»»ä½• Service Workerã€‚\n';
        } else {
          status += `âœ… æ‰¾åˆ° ${registrations.length} å€‹ Service Worker è¨»å†Šã€‚\n`;
        }
      } else {
        status += 'âŒ é€™å€‹ç€è¦½å™¨ä¸æ”¯æ´ Service Workerã€‚\n';
      }

      // 2. æ˜¯å¦é›¢ç·š
      if (!navigator.onLine) {
        status += 'ğŸ“¡ ä½ ç›®å‰ã€Œé›¢ç·šã€ã€‚\n';
      } else {
        status += 'ğŸŒ ä½ ç›®å‰ã€Œé€£ç·šä¸­ã€ã€‚\n';
      }

      // 3. å˜—è©¦å¾å¿«å–ä¸­è¼‰å…¥è³‡æº
      try {
        const response = await fetch('script.js', {cache: 'only-if-cached', mode: 'same-origin'});
        if (response.ok) {
          status += 'âœ… æˆåŠŸå¾å¿«å–è®€å– script.jsã€‚';
        } else {
          status += 'âŒ ç„¡æ³•å¾å¿«å–è®€å– script.jsã€‚';
        }
      } catch (e) {
        status += 'âš ï¸ å¿«å–è¼‰å…¥å¤±æ•—ï¼ˆå¯èƒ½æ˜¯å¿«å–æœªå»ºç«‹æˆ– iOS é™åˆ¶ï¼‰ã€‚';
      }

      document.getElementById('status').innerText = status;
    }

    checkStatus();
  </script>
</body>
</html>
